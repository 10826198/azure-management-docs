---
title: Scan registry images with Azure Defender
description: Learn about using Azure Defender for container registries to scan images in your Azure container registries
ms.topic: article
ms.date: 05/17/2021
---

# Scan registry images with Azure Defender

To scan images in your Azure container registries for vulnerabilities, you can integrate an Azure Marketplace solution, or enable Azure Security Center features for your container registry. If you use Azure Security Center, optionally enable **Azure Defender for container registries** at the subscription level to scan images for vulnerabilities. 

* Learn more about [Azure Defender for container registries](../security-center/defender-for-container-registries-intriduction.md)
* Learn more about [container security in Azure Security Center](../security-center/container-security.md)

## Registry operations by Azure Defender

Azure Security Center scans images that are pushed to a registry, imported into a registry, or any images pulled within the last 30 days. If vulnerabilities are detected, [recommended remediations](../security-center/defender-for-container-registries-usage.md#view-and-remediate-findings) appear in Azure Security Center.

 After you've taken the recommended steps to remediate the security issue, replace the image in your registry. Azure Defender rescans the image to confirm that the vulnerabilties are remediated. For details, see [Use Azure Defender for container registries](../security-center/defender-for-container-registries-usage.md).

> [!TIP]
> If [resource logs](monitor-service-reference.md#resource-logs) are collected for your registry, you'll see registry login events and image pull events generated by Azure Defender. These events are associated with an ID similar to `b21cb118-5a59-4628-bab0-3c3f0e434cg6`.


## Scanning a network-restricted registry

Azure Defender can scan images in a publicly accessible container registry or one that's protected with network access rules. If network rules are configured (you disabled public registry access, configured IP access rules, or created private endpoints), be sure to enable the network setting to [**allow trusted Microsoft services**](allow-access-trusted-services.md) to access the registry. By default, this setting is enabled in a new container registry.

> [!NOTE]
> After enabling the setting to allow access by trusted services, it can take several minutes before Azure Defender begins scanning registry images.




## Next steps

* Learn more about registry access by [trusted services](allow-access-trusted-services.md).
* To restrict access to a registry using a private endpoint in a virtual network, see [Configure Azure Private Link for an Azure container registry](container-registry-private-link.md).
* To set up registry firewall rules, see [Configure public IP network rules](container-registry-access-selected-networks.md).
